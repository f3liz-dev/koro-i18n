# Koro i18n Sync Workflow
#
# This workflow syncs translations between your repository and the Koro i18n platform.
# It runs automatically when translation source files change, or on schedule.
#
# Setup:
# 1. Create a project on the platform
# 2. Add a koro.config.json to your repository
# 3. Update PROJECT_NAME below
#
# No secrets needed - uses OIDC authentication!

name: i18n Sync

on:
  push:
    branches:
      - main
    paths:
      # Trigger on source language changes
      - 'locales/en/**'
      - 'koro.config.json'
  
  schedule:
    # Sync translations every 6 hours
    - cron: '0 */6 * * *'
  
  workflow_dispatch:
    inputs:
      action:
        description: 'Action to perform'
        required: false
        default: 'sync'
        type: choice
        options:
          - push
          - pull
          - sync

env:
  PROJECT_NAME: my-project  # Change this to your project name

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions:
      id-token: write  # Required for OIDC
      contents: write  # Required to push changes
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Sync translations
        uses: f3liz-dev/koro-i18n/.github/actions/sync@main
        with:
          project-name: ${{ env.PROJECT_NAME }}
          action: ${{ github.event.inputs.action || 'sync' }}
